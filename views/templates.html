<script type="text/template" id="crossTmpl">
<% for (var ci in crosses ) { 
var verticals = crosses[ci]["verticals"]; %>
<div class="col-md-4">
  <div class="panel panel-default">
    <div class="panel-heading">
      <a class="mybtn-link" href="crossEdit/<%= ci %>"><%= crosses[ci]["title"] %></a>
    </div>
    <div class="panel-body">    
      <% for ( var cj in verticals ) { %>
        <a class="mybtn-link" href="#/vertical/<%= cj %>"><%= verticals[cj].title %></a>
      <% } %>
    </div>
  </div>
</div>
<% } %>
</script>

<script type="text/template" id="verticalTmpl">
  <div class="panel panel-default">
    <div class="panel-heading">
      <a href='javascript:edit(<%=href%>)'><%=header%></a>
      <%=btnBack%> 
      <div class="checkbox inmenu right">
        <label><input id="wraptext" type="checkbox" onclick="wrapToggle(this.checked)">Wrap text</label>
      </div>
      <div class="checkbox inmenu right">
        <label><input id="editchain" type="checkbox" onclick="editChain(this.checked)">Edit chain</label>
      </div>
    </div>
    <table class="vertical table table-bordered table-striped"><tbody>
      <% for ( var ci in plints) { 
      var pairs = plints[ci].pairs; 
      var start = parseInt(plints[ci].start); %>
        <tr>
          <% if (query) { %>
            <td class="colv0">
              <a title="Cross <%=plints[ci].root[1]%>"><%=plints[ci].root[1]%></a>            
            </td>
            <td class="colv1">
              <a href="#/vertical/<%=plints[ci].parent[0]%>"title="Vertical <%=plints[ci].parent[1]%>"><%=plints[ci].parent[1]%></a>            
            </td>        
          <% } %>
          <td class="colv1" style="border-right: 2px solid #ddd;">
          <% var _title = "Plint: "+plints[ci].title+"\n"+plints[ci].modon+"\n"+users[plints[ci].modby]+"\nCommon data: "+plints[ci].comdata; %>
            <a href="#/plintEdit/<%=ci%>" title="<%= _title %>"><%= plints[ci].title %></a>
          </td>
          <% for ( var cj in pairs ) { 
            var t = pairs[cj][0]; 
            var found = '';
            if (t) { _title = t+"\n"+pairs[cj][1]+"\n"+users[pairs[cj][2]];
                     if (t.indexOf(query) >= 0) found = 'class="info"'; }
              else _title = ""; %>
            <td <%=found%>>
              <a title="<%= _title %>" href='javascript:edit("pair",<%=ci%>,<%=parseInt(cj)+1%>)'>
              <sup><%=parseInt(cj)+start%></sup><%= t %></a>
            </td>
          <% }; 
          t = plints[ci].comdata; 
          found = "commondata";
          if (t && query && t.indexOf(query) >= 0) found += " cdfound"; %>
          <td class="<%=found%>" style="border-left: 2px solid #ddd;"><%= t %></td>
        </tr>
      <% }; %>
    </tbody></table>
  </div>
</script>

<script type="text/template" id="chainEditTmpl">
<div class="col-md-6">
  <div class="panel panel-primary">
    <div class="panel-heading"><%=data.header%><%=btnBack%></div>
    <div class="panel-body">
      <p><i><%=data.modinfo%></i></p>
      <form class="form-horizontal chain" action="javascript:pairEditAccept()">
        <div class="form-group">
          <label class="col-md-2 control-label"><%=T._TITLE_%></label>
          <div class="col-md-8"><input name="title" class="form-control" value="<%=data.title%>"></div>
        </div>
        <button type="button" class="btn btn-sm btn-success pull-right" title="Add link to chain" onclick="addLink()">+</button>
        <table id="chaintable">
          <tr><% for ( var ci in tbheaders ) { print("<td>"+tbheaders[ci]+"</td>") } %> </tr>
        </table>
        <%=btnOkCancel%>       
      </form>
    </div>
  </div>
</div>
 
<div class="col-md-5">
  <div class="panel panel-default">
    <div class="panel-heading">Watch
        <button type="button" class="close" aria-hidden="true" onclick="history.back();return false;" title="Back">&times;</button>
    </div>
    <div class="panel-body">

    <br>

    </div>
    <input class="btn btn-warning" type="button" value="Refresh" onclick="refreshWatch()">
      <table class="table table-bordered" id="chaintablewatch">
          <tr class="info"><td>Link</td><td>Cross</td><td>Vertical</td><td>Plint</td><td>Pair</td></tr>
      </table>
  </div>
</div>
</script>

<script type="text/template" id="liveSearchTmpl">
<% for (var ci in search ) { %>
  <a><%=search[ci]%></a>
<% } %>
</script>

<script type="text/template" id="btnOkCancelTmpl">
<div><button class="btn pull-right btn-primary" onclick="history.back();return false;">Cancel</button>
<input type="submit" class="btn pull-right btn-primary"></div>
</script>

<script type="text/template" id="btnBackTmpl">
<button type="button" class="close" aria-hidden="true" onclick="history.back();return false;" title="Back (Esc)">&times;</button>
</script>

<script type="text/template" id="foundEditTmpl">
<div class="col-md-7">
  <div class="panel panel-primary">
    <div class="panel-heading"><%=header%><%=btnBack%></div>
    
    <div class="panel-body">
      <form class="form-horizontal found" action="javascript:foundEditAccept()">
        <button type="button" class="btn btn-sm btn-default pull-right" title="RegExp help" onclick="regexpHelp()">?</button>
        <div class="form-group">
          <label class="col-md-2 control-label"><%=T._FIND_%></label>
          <div class="col-md-8"><input name="find" class="form-control" value="<%=query%>" oninput="refreshFoundTable()"></div>
        </div>
        <div class="form-group">
          <label class="col-md-2 control-label"><%=T._REPLACE_%></label>
          <div class="col-md-8"><input name="replace" class="form-control" value="<%=query%>" oninput="refreshFoundTable()"></div>
        </div>
        <div class="form-group">
            <div class="checkbox col-md-offset-2 col-md-8"><label>
                  <input name="replacecheck" type="checkbox" checked="checked" onclick="refreshFoundTable()"><%=T._FOLLOW_%>
            </label></div>
        </div>
        
        <%=btnOkCancel%>
      </form>
    </div>
    <table class="table table-bordered table-condensed" id="foundtable">
      <tr class="info">
      <th width="15%"><%=tbheaders[0]%></th>
      <th width="12%"><%=tbheaders[1]%></th>
      <th width="10%"><%=tbheaders[2]%></th>
      <th width="8%"><%=tbheaders[3]%></th>
      <th>Title</th>
      </tr>
    </table>
    <div class="panel-footer"><div class="myright">Found <span id="footerstatus"></span> results.</div></div>
  </div>
</div>
</script>

<script type="text/template" id="verticalEditTmpl">
<div class="col-md-6">
  <div class="panel panel-primary">
    <div class="panel-heading"><%=header%><%=btnBack%></div>
    <div class="panel-body">
      <form class="form-horizontal chain" action="javascript:verticalEditAccept()">
        <div class="form-group">
          <label class="col-md-3 control-label"><%=T._TITLE_%></label>
          <div class="col-md-8"><input name="title" class="form-control" value="<%=title%>"></div>
        </div>
        
        <div class="form-group">
          <div class="checkbox col-md-offset-3 col-md-8"><label>
            <input name="delete" class="delete" type="checkbox">Delete vertical
          </label></div>
        </div>
        
        <div class="form-group">
          <label class="col-md-3 control-label">Plint title</label>
          <div class="col-md-3"><input name="title" class="form-control" value="M%1"></div>
          <label class="col-md-2 control-label">Count</label>
          <div class="col-md-3"><input type="number" min="0" max="100" name=title" class="form-control" value="0"></div>
        </div>
        
        <div class="form-group">
          <div class="checkbox col-md-offset-3 col-md-8"><label>
            <input name="start1" type="checkbox">Numeration start 1
          </label></div>
        </div>
        
        <div class="form-group">
          <label class="col-md-3 control-label">Common data</label>
          <div class="col-md-8">
            <div class="input-group">
                <input type="text" class="form-control">
                <span class="input-group-btn">
                    <button class="btn btn-default" type="button" title="Help" onclick="commondataHelp()">?</button>
                </span>
            </div>
          </div>        
        </div>        
        
        <div class="form-group">
          <div class="checkbox col-md-offset-3 col-md-8"><label>
            <input name="comdatareplace" class="delete" type="checkbox">Replace common data
          </label></div>
        </div>
        
        
        <table id="chaintable">
          <tr>
          <td><%=tbheaders[0]%></td>
          <td><%=tbheaders[1]%></td>
          <td><%=tbheaders[2]%></td>
          </tr>
          <tr>
          <td><selsect class="form-control"></selsect></td>
          <td><selsect class="form-control"></selsect></td>
          <td><selsect class="form-control"></selsect></td>
          </tr>
        </table>
        
        <%=btnOkCancel%>       
      </form>
    </div>

    <div class="panel-footer"><div class="myright">Found <span id="footerstatus"></span> results.</div></div>
  </div>
</div>
</script>
